# Промт для разработки фронтенда Digital URPAQ AI Agent

## Описание проекта

**Digital URPAQ AI Agent** - это AI-помощник для образовательного учреждения, который использует RAG (Retrieval-Augmented Generation) для ответов на вопросы пользователей на основе документов в базе знаний.

## Технический стек бэкенда

- **Framework**: Spring Boot 3.5.7 (WebFlux - реактивный)
- **Java**: 21
- **AI Model**: Ollama с моделью qwen2.5:1.5b
- **База данных**: Elasticsearch 8.17.0
- **Коммуникация**: WebSocket (реактивный)
- **Порт**: 8080

## API Спецификация

### WebSocket Endpoint

**URL**: `ws://localhost:8080/event-emitter`

**Протокол**: WebSocket

#### Формат сообщения от клиента
```
Простой текст (String) - вопрос пользователя
```

#### Формат ответа от сервера
```json
{
  "entity": "USER",
  "message": "текст вопроса пользователя",
  "timestamp": "2025-10-28T15:52:30",
  "response": {
    "entity": "AI_HELPER",
    "message": "ответ AI помощника",
    "timestamp": "2025-10-28T15:52:35"
  }
}
```

### Типы сущностей (EType)
- `USER` - "Пользователь"
- `AI_HELPER` - "DIGITAL URPAQ помошник"

## Требования к фронтенду

### Функциональные требования

1. **Чат интерфейс**
   - Отображение истории сообщений
   - Поле ввода для вопросов пользователя
   - Отправка сообщений через WebSocket
   - Получение и отображение ответов в реальном времени

2. **Визуальное разделение сообщений**
   - Сообщения пользователя (USER) - справа
   - Ответы AI помощника (AI_HELPER) - слева
   - Отображение временных меток

3. **UX/UI**
   - Современный, чистый дизайн
   - Адаптивная верстка (мобильные устройства, планшеты, десктоп)
   - Индикатор загрузки при ожидании ответа
   - Автоскролл к последнему сообщению
   - Анимации появления сообщений

4. **Обработка ошибок**
   - Уведомления при потере соединения
   - Переподключение к WebSocket при разрыве
   - Обработка ошибок отправки сообщений

### Технические требования

1. **WebSocket клиент**
   - Подключение к `ws://localhost:8080/event-emitter`
   - Отправка текстовых сообщений
   - Парсинг JSON ответов
   - Обработка жизненного цикла соединения

2. **Управление состоянием**
   - История сообщений
   - Статус соединения
   - Состояние загрузки

3. **Производительность**
   - Оптимизация рендеринга списка сообщений
   - Ленивая загрузка истории (если будет реализована на бэкенде)

## Рекомендуемый стек технологий
```
- Next.js 14+
- TypeScript
- WebSocket client
- Tailwind CSS
- React Context или Zustand
```

## TypeScript типы

```typescript
enum EType {
  USER = "USER",
  AI_HELPER = "AI_HELPER"
}

interface ChatResponse {
  entity: EType;
  message: string;
  timestamp: string;
}

interface ChatMessage {
  entity: EType;
  message: string;
  timestamp: string;
  response: ChatResponse;
}
```

## Пример использования WebSocket

```typescript
const ws = new WebSocket('ws://localhost:8080/event-emitter');

ws.onopen = () => {
  console.log('Connected to Digital URPAQ AI Agent');
};

ws.onmessage = (event) => {
  const chatMessage: ChatMessage = JSON.parse(event.data);
  // Обработка полученного сообщения
};

ws.onerror = (error) => {
  console.error('WebSocket error:', error);
};

ws.onclose = () => {
  console.log('Disconnected from server');
  // Попытка переподключения
};

// Отправка сообщения
const sendMessage = (text: string) => {
  if (ws.readyState === WebSocket.OPEN) {
    ws.send(text);
  }
};
```

## Особенности работы системы

1. **RAG система**: AI помощник использует документы из Elasticsearch для формирования ответов
2. **Обработка запросов**: 
   - Сначала запрос сокращается и структурируется
   - Затем ищутся релевантные документы
   - На основе найденной информации формируется ответ
3. **Категории информации**:
   - РАСПИСАНИЕ
   - КАБИНЕТЫ
   - УЧИТЕЛЯ
   - НАПРАВЛЕНИЯ

## Дизайн рекомендации

1. **Цветовая схема**
   - Использовать профессиональные, образовательные цвета
   - Четкое визуальное разделение USER и AI_HELPER сообщений
   - Темная/светлая тема (опционально)

2. **Типографика**
   - Читаемые шрифты (Inter, Roboto, Open Sans)
   - Достаточный размер текста для мобильных устройств

3. **Анимации**
   - Плавное появление сообщений
   - Индикатор печати при ожидании ответа
   - Анимация подключения/отключения

## Тестирование

1. Запустить бэкенд: `docker-compose up` или `./gradlew bootRun`
2. Проверить доступность WebSocket: `ws://localhost:8080/event-emitter`
3. Отправить тестовое сообщение
4. Проверить формат ответа

## Дополнительные возможности (опционально)

- [ ] История чата (сохранение в localStorage)
- [ ] Экспорт переписки
- [ ] Поддержка markdown в ответах
- [ ] Голосовой ввод
- [ ] Автодополнение вопросов
- [ ] Темная тема
- [ ] Мультиязычность (русский/казахский/английский)
- [ ] Оценка ответов AI (лайк/дизлайк)
- [ ] Предложенные вопросы

## Контакты и поддержка

- Бэкенд работает на порту: **8080**
- WebSocket endpoint: **/event-emitter**
- Elasticsearch: **9200** (для отладки, если нужно)
- Ollama: **11434** (для отладки, если нужно)
